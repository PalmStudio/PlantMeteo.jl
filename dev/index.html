<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · PlantMeteo.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://PalmStudio.github.io/PlantMeteo.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PlantMeteo.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PlantMeteo"><a class="docs-heading-anchor" href="#PlantMeteo">PlantMeteo</a><a id="PlantMeteo-1"></a><a class="docs-heading-anchor-permalink" href="#PlantMeteo" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/PalmStudio/PlantMeteo.jl">PlantMeteo</a>.</p><ul><li><a href="#PlantMeteo.AbstractAPI"><code>PlantMeteo.AbstractAPI</code></a></li><li><a href="#PlantMeteo.AbstractAtmosphere"><code>PlantMeteo.AbstractAtmosphere</code></a></li><li><a href="#PlantMeteo.Atmosphere"><code>PlantMeteo.Atmosphere</code></a></li><li><a href="#PlantMeteo.Constants"><code>PlantMeteo.Constants</code></a></li><li><a href="#PlantMeteo.OpenMeteo"><code>PlantMeteo.OpenMeteo</code></a></li><li><a href="#PlantMeteo.TimeStepTable"><code>PlantMeteo.TimeStepTable</code></a></li><li><a href="#PlantMeteo.Weather-Union{Tuple{Any}, Tuple{S}, Tuple{Any, S}} where S&lt;:NamedTuple"><code>PlantMeteo.Weather</code></a></li><li><a href="#PlantMeteo.air_density-NTuple{4, Any}"><code>PlantMeteo.air_density</code></a></li><li><a href="#PlantMeteo.atmosphere_emissivity-Tuple{Any, Any, Any}"><code>PlantMeteo.atmosphere_emissivity</code></a></li><li><a href="#PlantMeteo.compute_date!-Tuple{Any, Any, Any}"><code>PlantMeteo.compute_date!</code></a></li><li><a href="#PlantMeteo.compute_duration!-Tuple{Any, Any}"><code>PlantMeteo.compute_duration!</code></a></li><li><a href="#PlantMeteo.e_sat-Tuple{Any}"><code>PlantMeteo.e_sat</code></a></li><li><a href="#PlantMeteo.e_sat_slope-Tuple{Any}"><code>PlantMeteo.e_sat_slope</code></a></li><li><a href="#PlantMeteo.format_openmeteo!-Tuple{Any}"><code>PlantMeteo.format_openmeteo!</code></a></li><li><a href="#PlantMeteo.get_forecast-Tuple{OpenMeteo, Any, Any, Any}"><code>PlantMeteo.get_forecast</code></a></li><li><a href="#PlantMeteo.get_weather-Union{Tuple{P}, Tuple{Any, Any, P}} where P&lt;:Union{StepRange{Dates.Date, Dates.Day}, Vector{Dates.Date}}"><code>PlantMeteo.get_weather</code></a></li><li><a href="#PlantMeteo.latent_heat_vaporization-Tuple{Any, Any}"><code>PlantMeteo.latent_heat_vaporization</code></a></li><li><a href="#PlantMeteo.parse_hour"><code>PlantMeteo.parse_hour</code></a></li><li><a href="#PlantMeteo.psychrometer_constant-NTuple{4, Any}"><code>PlantMeteo.psychrometer_constant</code></a></li><li><a href="#PlantMeteo.read_weather-Tuple{Any, Vararg{Any}}"><code>PlantMeteo.read_weather</code></a></li><li><a href="#PlantMeteo.rh_from_e-Tuple{Any, Any}"><code>PlantMeteo.rh_from_e</code></a></li><li><a href="#PlantMeteo.rh_from_vpd-Tuple{Any, Any}"><code>PlantMeteo.rh_from_vpd</code></a></li><li><a href="#PlantMeteo.timesteps_durations-Tuple{Vector{Dates.DateTime}}"><code>PlantMeteo.timesteps_durations</code></a></li><li><a href="#PlantMeteo.vapor_pressure-Tuple{Any, Any}"><code>PlantMeteo.vapor_pressure</code></a></li><li><a href="#PlantMeteo.vpd-Tuple{Any, Any}"><code>PlantMeteo.vpd</code></a></li><li><a href="#PlantMeteo.γ_star-NTuple{6, Any}"><code>PlantMeteo.γ_star</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.AbstractAPI" href="#PlantMeteo.AbstractAPI"><code>PlantMeteo.AbstractAPI</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractAPI</code></pre><p>An abstract type for APIs. This is used to define the API to use for the weather forecast. You can get all available APIs using <code>subtype(AbstractAPI)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/generic_API.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.AbstractAtmosphere" href="#PlantMeteo.AbstractAtmosphere"><code>PlantMeteo.AbstractAtmosphere</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract atmospheric conditions type. The suptypes of AbstractAtmosphere should describe the atmospheric conditions for one time-step only, see <em>e.g.</em> <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/atmosphere.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.Atmosphere" href="#PlantMeteo.Atmosphere"><code>PlantMeteo.Atmosphere</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Atmosphere structure to hold all values related to the meteorology / atmosphere.</p><p><strong>Arguments</strong></p><ul><li><code>date&lt;:AbstractDateTime = Dates.now()</code>: the date of the record.</li><li><code>duration&lt;:Period = Dates.Second(1.0)</code>: the duration of the time-step in Dates.Period.</li><li><code>T</code> (°C): air temperature</li><li><code>Wind</code> (m s-1): wind speed</li><li><code>P = 101.325</code> (kPa): air pressure. The default value is at 1 atm, <em>i.e.</em> the mean sea-level</li></ul><p>atmospheric pressure on Earth.</p><ul><li><code>Rh = rh_from_vpd(VPD,eₛ)</code> (0-1): relative humidity</li><li><code>Precipitations=0.0</code> (mm): precipitations from atmosphere (<em>i.e.</em> rain, snow, hail, etc.)</li><li><code>Cₐ</code> (ppm): air CO₂ concentration</li><li><code>e = vapor_pressure(T,Rh)</code> (kPa): vapor pressure</li><li><code>eₛ = e_sat(T)</code> (kPa): saturated vapor pressure</li><li><code>VPD = eₛ - e</code> (kPa): vapor pressure deficit</li><li><code>ρ = air_density(T, P, constants.Rd, constants.K₀)</code> (kg m-3): air density</li><li><code>λ = latent_heat_vaporization(T, constants.λ₀)</code> (J kg-1): latent heat of vaporization</li><li><code>γ = psychrometer_constant(P, λ, constants.Cₚ, constants.ε)</code> (kPa K−1): psychrometer &quot;constant&quot;</li><li><code>ε = atmosphere_emissivity(T,e,constants.K₀)</code> (0-1): atmosphere emissivity</li><li><code>Δ = e_sat_slope(meteo.T)</code> (0-1): slope of the saturation vapor pressure at air temperature</li><li><code>clearness::A = 9999.9</code> (0-1): Sky clearness</li><li><code>Ri_SW_f::A = 9999.9</code> (W m-2): Incoming short wave radiation flux</li><li><code>Ri_PAR_f::A = 9999.9</code> (W m-2): Incoming PAR flux</li><li><code>Ri_NIR_f::A = 9999.9</code> (W m-2): Incoming NIR flux</li><li><code>Ri_TIR_f::A = 9999.9</code> (W m-2): Incoming TIR flux</li><li><code>Ri_custom_f::A = 9999.9</code> (W m-2): Incoming radiation flux for a custom waveband</li></ul><p><strong>Notes</strong></p><p>The structure can be built using only <code>T</code>, <code>Rh</code>, <code>Wind</code> and <code>P</code>. All other variables are optional and either let at their default value or automatically computed using the functions given in <code>Arguments</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/atmosphere.jl#L8-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.Constants" href="#PlantMeteo.Constants"><code>PlantMeteo.Constants</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Physical constants</p><p>The definition and default values are:</p><ul><li><code>K₀ = -273.15</code>: absolute zero (°C)</li><li><code>R = 8.314</code>: universal gas constant (<span>$J\ mol^{-1}\ K^{-1}$</span>).</li><li><code>Rd = 287.0586</code>: gas constant of dry air (<span>$J\ kg^{-1}\ K^{-1}$</span>).</li><li><code>Dₕ₀ = 21.5e-6</code>: molecular diffusivity for heat at base temperature, applied in the integrated form of the   Fick’s Law of diffusion (<span>$m^2\ s^{-1}$</span>). See eq. 3.10 from Monteith and Unsworth (2013).</li><li><code>Cₚ = 1013.0</code>: Specific heat of air at constant pressure (<span>$J\ K^{-1}\ kg^{-1}$</span>), also   known as efficiency of impaction of particles. See Allen et al. (1998), or Monteith and   Unsworth (2013). NB: bigleaf R package uses 1004.834 intead.</li><li><code>ε = 0.622</code>: ratio of molecular weights of water vapor and air. See Monteith and   Unsworth (2013).</li><li><code>λ₀ = 2.501</code>: latent heat of vaporization for water at 0 degree (<span>$J\ kg^{-1}$</span>).</li><li><code>σ = 5.670373e-08</code> <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law">Stefan-Boltzmann constant</a>   in (<span>$W\ m^{-2}\ K^{-4}$</span>).</li><li><code>Gbₕ_to_Gbₕ₂ₒ = 1.075</code>: conversion coefficient from conductance to heat to conductance to water   vapor.</li><li><code>Gsc_to_Gsw = 1.57</code>: conversion coefficient from stomatal conductance to CO₂ to conductance to water   vapor.</li><li><code>Gbc_to_Gbₕ = 1.32</code>: conversion coefficient from boundary layer conductance to CO₂ to heat.</li><li><code>Mₕ₂ₒ = 18.0e-3</code> (kg mol-1): Molar mass for water.</li></ul><p><strong>References</strong></p><p>Allen, Richard G., Luis S. Pereira, Dirk Raes, et Martin J Fao Smith. 1998. « Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56 » 300 (9): D05109.</p><p>Monteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/constants.jl#L1-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.OpenMeteo" href="#PlantMeteo.OpenMeteo"><code>PlantMeteo.OpenMeteo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">OpenMeteo()
OpenMeteo(vars)</code></pre><p>A type that defines the <a href="https://open-meteo.com/">open-meteo.com</a> API.  No need of an API key as it is free. Please keep in mind that the API is not free for commercial use, and that you should use it responsibly.</p><p><strong>Arguments</strong></p><ul><li><code>vars</code>: the variables needed, see <a href="https://open-meteo.com/en/docs">here</a>.</li></ul><p><strong>Sources</strong></p><ul><li><a href="https://open-meteo.com/">Open-Meteo.com</a>, under Attribution </li></ul><p>4.0 International (CC BY 4.0).</p><ul><li>Copernicus Climate Change Service information 2022 (Hersbach et al., 2018).</li></ul><p>Hersbach, H., Bell, B., Berrisford, P., Biavati, G., Horányi, A., Muñoz Sabater, J., Nicolas, J.,  Peubey, C., Radu, R., Rozum, I., Schepers, D., Simmons, A., Soci, C., Dee, D., Thépaut, J-N. (2018):  ERA5 hourly data on single levels from 1959 to present.  Copernicus Climate Change Service (C3S) Climate Data Store (CDS). (Updated daily), 10.24381/cds.adbb2d47</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/open-meteo.jl#L4-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.TimeStepTable" href="#PlantMeteo.TimeStepTable"><code>PlantMeteo.TimeStepTable</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TimeStepTable(vars)</code></pre><p><code>TimeStepTable</code> stores variables values for each time step, <em>e.g.</em> weather variables. It implements the <code>Tables.jl</code> interface, so it can be used with any package that uses  <code>Tables.jl</code> (like <code>DataFrames.jl</code>).</p><p>You can extend <code>TimeStepTable</code> to store your own variables by defining a new type for the  storage of the variables. You can look at the <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> type  for an example implementation, or the <code>Status</code> type from  <a href="https://github.com/VEZY/PlantSimEngine.jl"><code>PlantSimEngine.jl</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">data = TimeStepTable(
    [
        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),
        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)
    ]
)

# We can convert it into a DataFrame:
using DataFrames
df = DataFrame(data)

# We can also create a TimeStepTable from a DataFrame:
TimeStepTable(df)

# Note that by default it will use NamedTuple to store the variables
# for high performance. If you want to use a different type, you can
# specify it as a type parameter (if you want *e.g.* mutability or pre-computations):
TimeStepTable{Atmosphere}(df)
# Or if you use PlantSimEngine: TimeStepTable{Status}(df)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/TimeStepTable.jl#L1-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.Weather-Union{Tuple{Any}, Tuple{S}, Tuple{Any, S}} where S&lt;:NamedTuple" href="#PlantMeteo.Weather-Union{Tuple{Any}, Tuple{S}, Tuple{Any, S}} where S&lt;:NamedTuple"><code>PlantMeteo.Weather</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Weather(data[, metadata])</code></pre><p>Defines the weather, <em>i.e.</em> the local conditions of the Atmosphere for one or more time-steps. Each time-step is described using the <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> structure, and the resulting structure is a <code>TimeStepTable</code>.</p><p>The simplest way to instantiate a <code>Weather</code> is to use a <code>DataFrame</code> as input.</p><p>The <code>DataFrame</code> should be formated such as each row is an observation for a given time-step and each column is a variable. The column names should match exactly the variables names of the <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> structure:</p><p><strong>See also</strong></p><ul><li>the <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> structure</li><li>the <a href="#PlantMeteo.read_weather-Tuple{Any, Vararg{Any}}"><code>read_weather</code></a> function to read Archimed-formatted meteorology data.</li></ul><p><strong>Examples</strong></p><p>Example of weather data defined by hand (cumbersome):</p><pre><code class="language-julia hljs">w = Weather(
    [
        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),
        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),
        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)
    ],
    (
        site = &quot;Test site&quot;,
        important_metadata = &quot;this is important and will be attached to our weather data&quot;
    )
)</code></pre><p><code>Weather</code> is a <code>TimeStepTable{Atmosphere}</code>, so we can convert it into a <code>DataFrame</code>:</p><pre><code class="language-julia hljs">using DataFrames
df = DataFrame(w)</code></pre><p>And then back into <code>Weather</code> to make a <code>TimeStepTable{Atmosphere}</code>:</p><pre><code class="language-julia hljs">Weather(df, (site = &quot;My site&quot;,))</code></pre><p>Of course it works with any <code>DataFrame</code> that has at least the required variables listed in <code>Atmosphere</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/weather.jl#L1-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.air_density-NTuple{4, Any}" href="#PlantMeteo.air_density-NTuple{4, Any}"><code>PlantMeteo.air_density</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">air_density(Tₐ, P)
air_density(Tₐ, P, Rd, K₀)</code></pre><p>ρ, the air density (kg m-3).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (Celsius degree): air temperature</li><li><code>P</code> (kPa): air pressure</li><li><code>Rd</code> (J kg-1 K-1): gas constant of dry air (see Foken p. 245, or R bigleaf package).</li><li><code>K₀</code> (Celsius degree): temperature in Celsius degree at 0 Kelvin</li></ul><p><strong>Note</strong></p><p>Rd and K₀ are Taken from <a href="#PlantMeteo.Constants"><code>Constants</code></a> if not provided.</p><p><strong>References</strong></p><p>Foken, T, 2008: Micrometeorology. Springer, Berlin, Germany.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L31-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.atmosphere_emissivity-Tuple{Any, Any, Any}" href="#PlantMeteo.atmosphere_emissivity-Tuple{Any, Any, Any}"><code>PlantMeteo.atmosphere_emissivity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">atmosphere_emissivity(Tₐ,eₐ)</code></pre><p>Emissivity of the atmoshpere at a given temperature and vapor pressure.</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>eₐ</code> (kPa): air vapor pressure</li><li><code>K₀</code> (°C): absolute zero</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Tₐ = 20.0
VPD = 1.5
atmosphere_emissivity(Tₐ, vapor_pressure(Tₐ,VPD))</code></pre><p><strong>References</strong></p><p>Leuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell &amp; Environment 18 (10): 1183‑1200.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/emissivity.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.compute_date!-Tuple{Any, Any, Any}" href="#PlantMeteo.compute_date!-Tuple{Any, Any, Any}"><code>PlantMeteo.compute_date!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_date!(df, date_format, hour_format)</code></pre><p>Compute the <code>date</code> column depending on several cases:</p><ul><li>If it is already in the DataFrame and is a <code>DateTime</code>, does nothing.</li><li>If it is a <code>String</code>, tries and parse it using a user-input <code>DateFormat</code></li><li>If it is a <code>Date</code>, return it as is, or try to make it a <code>DateTime</code> if there&#39;s a column named</li></ul><p><code>hour_start</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/read_weather.jl#L98-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.compute_duration!-Tuple{Any, Any}" href="#PlantMeteo.compute_duration!-Tuple{Any, Any}"><code>PlantMeteo.compute_duration!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_duration!(df, hour_format)</code></pre><p>Compute the <code>duration</code> column depending on several cases:</p><ul><li>If it is already in the DataFrame, does nothing.</li><li>If it is not, but there&#39;s a column named <code>hour_end</code> and another one either called <code>hour_start</code></li></ul><p>or <code>date</code>, compute the duration from the period between <code>hour_start</code> (or <code>date</code>) and <code>hour_end</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/read_weather.jl#L144-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.e_sat-Tuple{Any}" href="#PlantMeteo.e_sat-Tuple{Any}"><code>PlantMeteo.e_sat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">e_sat(T)</code></pre><p>Saturated water vapour pressure (es, in kPa) at given temperature <code>T</code> (°C). See Jones (1992) p. 110 for the equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L11-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.e_sat_slope-Tuple{Any}" href="#PlantMeteo.e_sat_slope-Tuple{Any}"><code>PlantMeteo.e_sat_slope</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">e_sat_slope(T)</code></pre><p>Slope of the vapor pressure saturation curve at a given temperature <code>T</code> (°C).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.format_openmeteo!-Tuple{Any}" href="#PlantMeteo.format_openmeteo!-Tuple{Any}"><code>PlantMeteo.format_openmeteo!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">format_openmeteo(data)</code></pre><p>Format the JSON file returned by the Open-Meteo API into a vector  of <a href="#PlantMeteo.Atmosphere"><code>Atmosphere</code></a>. The function also updates some units in <code>data</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/open-meteo.jl#L129-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.get_forecast-Tuple{OpenMeteo, Any, Any, Any}" href="#PlantMeteo.get_forecast-Tuple{OpenMeteo, Any, Any, Any}"><code>PlantMeteo.get_forecast</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_forecast(params::OpenMeteo, lat, lon, period; verbose=true)</code></pre><p>A function that returns the weather forecast from OpenMeteo.com</p><p><strong>Arguments</strong></p><ul><li><code>lat</code>: Latitude of the location</li><li><code>lon</code>: Longitude of the location</li><li><code>period::Union{StepRange{Date, Day}, Vector{Dates.Date}}</code>: Period of the forecast</li><li><code>verbose</code>: If <code>true</code>, print more information in case of errors or warnings.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using PlantMeteo, Dates
lat = 48.8566
lon = 2.3522
period = Dates.today():Dates.Day(1):Dates.today()+Dates.Day(3)
params = OpenMeteo()
get_forecast(params, lat, lon, period)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/open-meteo.jl#L43-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.get_weather-Union{Tuple{P}, Tuple{Any, Any, P}} where P&lt;:Union{StepRange{Dates.Date, Dates.Day}, Vector{Dates.Date}}" href="#PlantMeteo.get_weather-Union{Tuple{P}, Tuple{Any, Any, P}} where P&lt;:Union{StepRange{Dates.Date, Dates.Day}, Vector{Dates.Date}}"><code>PlantMeteo.get_weather</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_weather(lat, lon, period::Dates.Date; api::DataType=OpenMeteo, sink=TimeStepTable)</code></pre><p>Returns the weather forecast for a given location and time using a weather API.</p><p><strong>Arguments</strong></p><ul><li><code>lat::Float64</code>: Latitude of the location</li><li><code>lon::Float64</code>: Longitude of the location</li><li><code>period::Union{StepRange{Date, Day}, Vector{Dates.Date}}</code>: Period of the forecast</li><li><code>api::DataType=OpenMeteo</code>: API to use for the forecast.</li><li><code>sink::DataType=TimeStepTable</code>: Type of the output. Default is <code>TimeStepTable</code>, but it</li></ul><p>can be any type that implements the <code>Tables.jl</code> interface, such as <code>DataFrames</code>.</p><p><strong>Details</strong></p><p>We can get all available APIs using <code>subtype(AbstractAPI)</code>. Please keep in mind that the default <a href="#PlantMeteo.OpenMeteo"><code>OpenMeteo</code></a> API is not free for commercial use, and that you should use it responsibly.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using PlantMeteo, Dates
julia&gt; get_weather(48.8566, 2.3522, Date(2020, 1, 1):Day(1):Date(2020, 1, 3))
3-element Array{Weather,1}:
 Weather(1.0, 0.0, 0.0)
 Weather(1.0, 0.0, 0.0)
 Weather(1.0, 0.0, 0.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/generic_API.jl#L10-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.latent_heat_vaporization-Tuple{Any, Any}" href="#PlantMeteo.latent_heat_vaporization-Tuple{Any, Any}"><code>PlantMeteo.latent_heat_vaporization</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">latent_heat_vaporization(Tₐ,λ₀)
latent_heat_vaporization(Tₐ)</code></pre><p>λ, the latent heat of vaporization for water (J kg-1).</p><p><strong>Arguments</strong></p><ul><li><code>Tₐ</code> (°C): air temperature</li><li><code>λ₀</code>: latent heat of vaporization for water at 0 degree Celsius. Taken from <code>Constants().λ₀</code></li></ul><p>if not provided (see <a href="#PlantMeteo.Constants"><code>Constants</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L141-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.parse_hour" href="#PlantMeteo.parse_hour"><code>PlantMeteo.parse_hour</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">parse_hour(h, hour_format=Dates.DateFormat(&quot;HH:MM:SS&quot;))</code></pre><p>Parse an hour that can be of several formats:</p><ul><li><code>Time</code>: return it as is</li><li><code>String</code>: try to parse it using the user-input <code>DateFormat</code></li><li><code>DateTime</code>: transform it into a <code>Time</code></li></ul><p><strong>Arguments</strong></p><ul><li><code>h</code>: hour to parse</li><li><code>hour_format::DateFormat</code>: user-input format to parse the hours</li></ul><p><strong>Examples</strong></p><p>As a string:</p><pre><code class="language-julia-repl hljs">julia&gt; PlantMeteo.parse_hour(&quot;12:00:00&quot;)
12:00:00</code></pre><p>As a <code>Time</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; PlantMeteo.parse_hour(Dates.Time(12, 0, 0))
12:00:00</code></pre><p>As a <code>DateTime</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; PlantMeteo.parse_hour(Dates.DateTime(2020, 1, 1, 12, 0, 0))
12:00:00</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/read_weather.jl#L189-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.psychrometer_constant-NTuple{4, Any}" href="#PlantMeteo.psychrometer_constant-NTuple{4, Any}"><code>PlantMeteo.psychrometer_constant</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">psychrometer_constant(P, λ, Cₚ, ε)
psychrometer_constant(P, λ)</code></pre><p>γ, the psychrometer constant, also called psychrometric constant (kPa K−1). See Monteith and Unsworth (2013), p. 222.</p><p><strong>Arguments</strong></p><ul><li><code>P</code> (kPa): air pressure</li><li><code>λ</code> (<span>$J\ kg^{-1}$</span>): latent heat of vaporization for water (see <a href="#PlantMeteo.latent_heat_vaporization-Tuple{Any, Any}"><code>latent_heat_vaporization</code></a>)</li><li><code>Cₚ</code> (J kg-1 K-1): specific heat of air at constant pressure (<span>$J\ K^{-1}\ kg^{-1}$</span>)</li><li><code>ε</code> (Celsius degree): temperature in Celsius degree at 0 Kelvin</li></ul><p><strong>Note</strong></p><p>Cₚ, ε and λ₀ are taken from <a href="#PlantMeteo.Constants"><code>Constants</code></a> if not provided.</p><pre><code class="language-julia hljs">Tₐ = 20.0

λ = latent_heat_vaporization(Tₐ, λ₀)
psychrometer_constant(100.0, λ)</code></pre><p><strong>References</strong></p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L61-L93">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.read_weather-Tuple{Any, Vararg{Any}}" href="#PlantMeteo.read_weather-Tuple{Any, Vararg{Any}}"><code>PlantMeteo.read_weather</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_weather(file[,args...];
    date_format = DateFormat(&quot;yyyy-mm-ddTHH:MM:SS.s&quot;),
    hour_format = DateFormat(&quot;HH:MM:SS&quot;)
)</code></pre><p>Read a meteo file. The meteo file is a CSV, and optionnaly with metadata in a header formatted as a commented YAML. The column names <strong>and units</strong> should match exactly the fields of <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a>, or the user should provide their transformation as arguments (<code>args</code>) to help mapping the two. The transformations are given as for <code>DataFrames</code>.</p><p><strong>Note</strong></p><p>The variables found in the file will be used as is if not transformed, and not recomputed from the other variables. Please check that all variables have the same units as in the <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> structure.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: path to a meteo file</li><li><code>var_names = Dict()</code>: A Dict to map the file variable names to the Atmosphere variable names</li><li><code>date_format = DateFormat(&quot;yyyy-mm-ddTHH:MM:SS.s&quot;)</code>: the format for the <code>DateTime</code> columns</li><li><code>hour_format = DateFormat(&quot;HH:MM:SS&quot;)</code>: the format for the <code>Time</code> columns (<em>e.g.</em> <code>hour_start</code>)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Dates

file = joinpath(dirname(dirname(pathof(PlantMeteo))),&quot;test&quot;,&quot;data&quot;,&quot;meteo.csv&quot;)

meteo = read_weather(
    file,
    :temperature =&gt; :T,
    :relativeHumidity =&gt; (x -&gt; x ./100) =&gt; :Rh,
    :wind =&gt; :Wind,
    :atmosphereCO2_ppm =&gt; :Cₐ,
    date_format = DateFormat(&quot;yyyy/mm/dd&quot;)
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/APIs/read_weather.jl#L1-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.rh_from_e-Tuple{Any, Any}" href="#PlantMeteo.rh_from_e-Tuple{Any, Any}"><code>PlantMeteo.rh_from_e</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rh_from_e(VPD,eₛ)</code></pre><p>Conversion between e (kPa) and rh (0-1).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">rh_from_e(1.5,25.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/conversions.jl#L17-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.rh_from_vpd-Tuple{Any, Any}" href="#PlantMeteo.rh_from_vpd-Tuple{Any, Any}"><code>PlantMeteo.rh_from_vpd</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rh_from_vpd(VPD,eₛ)</code></pre><p>Conversion between VPD and rh.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">eₛ = e_sat(Tₐ)
rh_from_vpd(1.5,eₛ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/conversions.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.timesteps_durations-Tuple{Vector{Dates.DateTime}}" href="#PlantMeteo.timesteps_durations-Tuple{Vector{Dates.DateTime}}"><code>PlantMeteo.timesteps_durations</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">timesteps_durations(datetime::Dates.DateTime; verbose=true)</code></pre><p>Duration in sensible units (e.g. 1 hour, or 1 day), computed as the  duration between a step and the previous step. The first one is unknown, so we force it as the same as all (if unique), or the second one (if not) with a warning.</p><p>The function returns a <code>Dates.CompoundPeriod</code> because it helps finding a sensible default from a milliseconds period (<em>e.g.</em> 1 Hour or 1 Day).</p><p><strong>Arguments</strong></p><ul><li><code>datetime::Vector{Dates.DateTime}</code>: Vector of dates</li><li><code>verbose::Bool=true</code>: If <code>true</code>, print a warning if the duration is not </li></ul><p>constant between the time steps.</p><p><strong>Examples</strong></p><pre><code class="language-jldocs hljs">julia&gt; timesteps_durations([Dates.DateTime(2019, 1, 1, 0), Dates.DateTime(2019, 1, 1, 1)])
2-element Vector{Dates.CompoundPeriod}:
 1 hour
 1 hour</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/duration.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.vapor_pressure-Tuple{Any, Any}" href="#PlantMeteo.vapor_pressure-Tuple{Any, Any}"><code>PlantMeteo.vapor_pressure</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vapor_pressure(Tₐ, rh)</code></pre><p>Vapor pressure (kPa) at given temperature (°C) and relative hunidity (0-1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.vpd-Tuple{Any, Any}" href="#PlantMeteo.vpd-Tuple{Any, Any}"><code>PlantMeteo.vpd</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vpd(VPD,eₛ)</code></pre><p>Compute vapor pressure deficit (kPa) from the air relative humidity (0-1) and temperature (°C).</p><p>The computation simply uses vpd = eₛ - e.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">vpd(0.4,25.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/conversions.jl#L33-L45">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PlantMeteo.γ_star-NTuple{6, Any}" href="#PlantMeteo.γ_star-NTuple{6, Any}"><code>PlantMeteo.γ_star</code></a> — <span class="docstring-category">Method</span></header><section><div><p>γ<em>star(γ, a</em>sh, a_s, rbv, Rsᵥ, Rbₕ)</p><p>γ∗, the apparent value of psychrometer constant (kPa K−1).</p><p><strong>Arguments</strong></p><ul><li><code>γ</code> (kPa K−1): psychrometer constant</li><li><code>aₛₕ</code> (1,2): number of faces exchanging heat fluxes (see Schymanski et al., 2017)</li><li><code>aₛᵥ</code> (1,2): number of faces exchanging water fluxes (see Schymanski et al., 2017)</li><li><code>Rbᵥ</code> (s m-1): boundary layer resistance to water vapor</li><li><code>Rsᵥ</code> (s m-1): stomatal resistance to water vapor</li><li><code>Rbₕ</code> (s m-1): boundary layer resistance to heat</li></ul><p><strong>Note</strong></p><p>Using the corrigendum from Schymanski et al. (2017) in here so the definition of <a href="@ref"><code>latent_heat</code></a> remains generic.</p><p>Not to be confused with <a href="@ref"><code>Γ_star</code></a> in FcVB model, which is the CO₂ compensation point.</p><p><strong>References</strong></p><p>Monteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.</p><p>Schymanski, Stanislaus J., et Dani Or. 2017. Leaf-Scale Experiments Reveal an Important Omission in the Penman–Monteith Equation ». Hydrology and Earth System Sciences 21 (2): 685‑706. https://doi.org/10.5194/hess-21-685-2017.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/PalmStudio/PlantMeteo.jl/blob/9ec177dc7aa27695a9a085837216f26717280efd/src/variables_computations.jl#L105-L135">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Thursday 22 December 2022 12:16">Thursday 22 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

var documenterSearchIndex = {"docs":
[{"location":"weather-apis/#Weather-Data-Sources","page":"Weather Data Sources","title":"Weather Data Sources","text":"This guide explains how PlantMeteo handles weather ingestion and export.","category":"section"},{"location":"weather-apis/#Design-Intent","page":"Weather Data Sources","title":"Design Intent","text":"The package separates concerns:\n\ningestion/parsing (read_weather, API backends)\ncanonical weather representation (Weather, Atmosphere)\noptional conversion to sink formats (DataFrame, custom table sinks)\n\nThis keeps model code independent of source-specific quirks.","category":"section"},{"location":"weather-apis/#Path-1:-Local-Files-with-read_weather","page":"Weather Data Sources","title":"Path 1: Local Files with read_weather","text":"Use this path when data comes from stations, archives, or partner pipelines.\n\nYou can map source-specific column names and units to PlantMeteo variables, and get a standardized Weather table with parsed dates/durations and preserved metadata.\n\nusing PlantMeteo\nusing Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))), \"test\", \"data\", \"meteo.csv\")\n\nmeteo = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./ 100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\n(length(meteo), metadatakeys(meteo))","category":"section"},{"location":"weather-apis/#Round-trip-Export-with-write_weather","page":"Weather Data Sources","title":"Round-trip Export with write_weather","text":"Write a clean weather file for reuse, including metadata.\n\nFor example we can verify the exported file reproduces the same records:\n\nroundtrip_ok = mktempdir() do tmp\n    out = joinpath(tmp, \"meteo_out.csv\")\n    write_weather(out, meteo)\n    meteo2 = read_weather(out; duration = Dates.Minute)\n    length(meteo) == length(meteo2) && meteo2[1].T == meteo[1].T\nend\n\nroundtrip_ok","category":"section"},{"location":"weather-apis/#Path-2:-API-Retrieval-with-get_weather","page":"Weather Data Sources","title":"Path 2: API Retrieval with get_weather","text":"Use this path when you don't have local data or need forecast/history for coordinates and dates.\n\nThe default API uses Open-Meteo. You can control units, timezone, and model selection before requests, and get a configured API object you can reuse.\n\nparams = OpenMeteo(\n    units = OpenMeteoUnits(\n        temperature_unit = \"celsius\",\n        windspeed_unit = \"ms\",\n        precipitation_unit = \"mm\"\n    ),\n    timezone = \"UTC\",\n    models = [\"best_match\"]\n)\n\n(params.timezone, params.models, params.units.temperature_unit)","category":"section"},{"location":"weather-apis/#Define-Your-Own-API-Via-Our-Interface","page":"Weather Data Sources","title":"Define Your Own API Via Our Interface","text":"Any type implementing get_forecast can be plugged into get_weather. For example, we can define a DemoAPI that returns a fixed weather series for any request:\n\nstruct DemoAPI <: PlantMeteo.AbstractAPI end\n\nfunction PlantMeteo.get_forecast(::DemoAPI, lat, lon, period; verbose=true, kwargs...)\n    hours = DateTime(period[1]):Hour(1):DateTime(period[end]) + Hour(23)\n    rows = Atmosphere[\n        Atmosphere(\n            date = t,\n            duration = Hour(1),\n            T = 20.0,\n            Wind = 1.0,\n            Rh = 0.6,\n            P = 101.3,\n            Ri_SW_f = 250.0\n        )\n        for t in hours\n    ]\n    TimeStepTable(rows, (latitude = lat, longitude = lon, source = \"demo\"))\nend\n\nperiod = Date(2025, 1, 1):Day(1):Date(2025, 1, 2)\ndemo = get_weather(48.8566, 2.3522, period; api = DemoAPI())\n\n(length(demo), first(demo).date, last(demo).date)","category":"section"},{"location":"weather-apis/#Switch-the-Output-Sink","page":"Weather Data Sources","title":"Switch the Output Sink","text":"You can use the sink keyword to get a different output format. For example, we can get a summary of the demo API output instead of the full weather table:\n\nsummary = get_weather(\n    48.8566,\n    2.3522,\n    period;\n    api = DemoAPI(),\n    sink = x -> (n = length(x), first_T = first(x.T), last_date = last(x.date))\n)\n\nsummary\n\nThe sink argument can be any sink that implements the Tables.jl interface, like DataFrame. This allows you to integrate with downstream code that expects specific formats without changing the core API logic.","category":"section"},{"location":"getting-started/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"This tutorial introduces the package through a realistic first workflow.","category":"section"},{"location":"getting-started/#Goal","page":"Getting Started","title":"Goal","text":"By the end, you will have:\n\nloaded weather into a Weather table\ninspected the standardized variables\naggregated fine-step weather into model-friendly steps","category":"section"},{"location":"getting-started/#Why-This-Matters","page":"Getting Started","title":"Why This Matters","text":"Most weather workflows fail at the interface between raw data and model expectations:\n\ncolumns are named differently across sources\ndurations and timestamps are not consistently encoded\nmodel clocks rarely match source resolution\n\nThe examples below show how PlantMeteo addresses these issues step by step.","category":"section"},{"location":"getting-started/#1.-Read-and-Standardize-a-Weather-File","page":"Getting Started","title":"1. Read and Standardize a Weather File","text":"Convert heterogeneous input columns into Atmosphere-compatible variables and get a typed weather table (TimeStepTable{Atmosphere}) with known fields:\n\nusing PlantMeteo\nusing Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))), \"test\", \"data\", \"meteo.csv\")\n\nmeteo = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./ 100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\nmeteo","category":"section"},{"location":"getting-started/#2.-Inspect-the-Data-You-Will-Feed-to-Models","page":"Getting Started","title":"2. Inspect the Data You Will Feed to Models","text":"Each row is an Atmosphere. You can get a row by indexing the table with a single index:\n\nfirst_row = meteo[1]\nfirst_row\n\nAnd because PlantMeteo implements the Tables.jl interface, table columns are easy to inspect and manipulate like a DataFrame. For example to get the temperature column as a vector:\n\nmeteo.T\n\nTimeStepTable also supports matrix-like indexing on rows and columns:\n\nmeteo[:T]      # full column by Symbol\nmeteo[\"T\"]     # full column by String\nmeteo[1]       # one row\nmeteo[1:2]     # row subset as TimeStepTable\nmeteo[1, :]    # one row (matrix-like syntax)\nmeteo[1, :T]   # one cell by row + Symbol column\nmeteo[1, \"T\"]  # one cell by row + String column\nmeteo[1:2, :T] # vector slice from one column\nmeteo[1:2, \"T\"]","category":"section"},{"location":"getting-started/#3.-Sample-Weather-to-Match-a-Model-Time-Step","page":"Getting Started","title":"3. Sample Weather to Match a Model Time Step","text":"Sometimes models require weather at a coarser time step than the source data. For example, you may have hourly weather but want daily values for a crop model. PlantMeteo's sampling functions let you aggregate weather from source resolution to model resolution, and get an aggregated Atmosphere row per query step.\n\nFor example we can build a fake 2-day hourly series and sample it to get a daily-like Atmosphere for the 24th hour, using a rolling 24-source-step window:\n\n# Build a longer hourly series for sampling demonstrations.\nbase = DateTime(2025, 1, 1)\nmeteo_hourly = Weather([\n    Atmosphere(\n        date = base + Hour(i),\n        duration = Hour(1),\n        T = 10.0 + i,\n        Wind = 1.0,\n        Rh = 0.55,\n        P = 100.0,\n        Ri_SW_f = 200.0\n    )\n    for i in 0:47\n])\n\nprepared = prepare_weather_sampler(meteo_hourly)\nwindow = RollingWindow(24.0)  # trailing 24-source-step window\nsampled = sample_weather(prepared, 24; window = window)\n\n# Get the temperature from the sampled row, which is a daily-averaged value of the 24 hourly source steps:\n(;sampled.duration, sampled.date, sampled.T)\n\nThis value is the mean of the 24 hourly temperatures from the source data, which matches our expectation for a daily-like sample:\n\nusing Statistics\nmean(meteo_hourly[i].T for i in 1:24)","category":"section"},{"location":"getting-started/#4.-Precompute-Sampling-for-Whole-Runs","page":"Getting Started","title":"4. Precompute Sampling for Whole Runs","text":"Avoid repeated sampling work in long simulation loops, and get a cached sampled table for each requested sampling window:\n\ntables = materialize_weather(prepared; windows = [window])\ndaily_like = tables[window]\n\n(length(daily_like), daily_like[24].T ≈ sampled.T, length(meteo_hourly))","category":"section"},{"location":"getting-started/#5.-Override-Default-Sampling-Rules-(Optional)","page":"Getting Started","title":"5. Override Default Sampling Rules (Optional)","text":"Encode model-specific aggregation rules per variable. Transforms are normalized and applied for the current call:\n\ncustom_transforms = (\n    T = MeanWeighted(),\n    Tmax = (source = :T, reducer = MaxReducer()),\n    Tsum = (source = :T, reducer = SumReducer())\n)\n\ncustom_row = sample_weather(prepared, 24; window = window, transforms = custom_transforms)\n(custom_row.T, custom_row.Tmax, custom_row.Tsum)","category":"section"},{"location":"getting-started/#Next-Steps","page":"Getting Started","title":"Next Steps","text":"Weather Data Sources: deeper look at file/API ingestion and export.\nWeather Sampling: windows, reducers, transforms, and caching strategy.\nAPI: full reference for all exported symbols.","category":"section"},{"location":"weather-sampling/#Weather-Sampling","page":"Weather Sampling","title":"Weather Sampling","text":"This guide explains how to align raw weather time steps with model requirements.","category":"section"},{"location":"weather-sampling/#Why-Sampling?","page":"Weather Sampling","title":"Why Sampling?","text":"A model often needs weather at a different temporal scale than the source data. Examples:\n\nsource meteo is hourly, model step is 3 hours\nsource meteo is sub-hourly, model step is daily\na simulation needs both rolling and calendar-based aggregates\n\nThe sampling API makes these choices explicit and testable.","category":"section"},{"location":"weather-sampling/#Sampling-Workflow","page":"Weather Sampling","title":"Sampling Workflow","text":"define the source weather table\nprepare a sampler object (with optional caching)\nchoose a window specification\nsample one step or materialize full sampled tables","category":"section"},{"location":"weather-sampling/#1.-Create-a-Small,-Predictable-Weather-Series","page":"Weather Sampling","title":"1. Create a Small, Predictable Weather Series","text":"For this example we'll use simple values so aggregation effects are easy to verify. We make 48 hourly rows (two days) with monotonic T:\n\nusing PlantMeteo\nusing Dates\nusing Statistics\n\nbase = DateTime(2025, 1, 1)\nmeteo = Weather([\n    Atmosphere(\n        date = base + Hour(i),\n        duration = Hour(1),\n        T = 10.0 + i,\n        Wind = 1.0,\n        Rh = 0.50 + 0.005 * i,\n        P = 100.0,\n        Ri_SW_f = 100.0 + 10.0 * i\n    )\n    for i in 0:47\n])\n\nmeteo","category":"section"},{"location":"weather-sampling/#2.-Prepare-Sampler-State","page":"Weather Sampling","title":"2. Prepare Sampler State","text":"We can normalize transforms and enable query-level memoization with prepare_weather_sampler. This is optional but can speed up repeated calls with the same windows. This is done so that repeated identical calls can return cached objects (lazy=true).\n\nprepared = prepare_weather_sampler(meteo)  # lazy cache enabled by default\ntypeof(prepared)","category":"section"},{"location":"weather-sampling/#3.-Rolling-Window-Sampling","page":"Weather Sampling","title":"3. Rolling Window Sampling","text":"We can then aggregate over a trailing window in source-step units using sample_weather, which returns one aggregated Atmosphere.\n\nwindow2 = RollingWindow(2.0)\nrow3 = sample_weather(prepared, 3; window = window2)\nrow3_cached = sample_weather(prepared, 3; window = window2)\n\n(row3.T, row3.Tmin, row3.Tmax, row3_cached === row3)\n\nsample_weather provides default transforms for common variables (i.e. the ones in Atmosphere), but you can override them with custom rules (see next section).","category":"section"},{"location":"weather-sampling/#4.-Override-Variable-wise-Aggregation-Rules","page":"Weather Sampling","title":"4. Override Variable-wise Aggregation Rules","text":"We can match aggregation logic to model semantics by overriding variable-wise aggregation rules. Custom transforms are normalized and applied for this call.\n\ncustom = (\n    T = MeanWeighted(),\n    Tmax = (source = :T, reducer = MaxReducer()),\n    Tsum = (source = :T, reducer = SumReducer())\n)\n\nrow_custom = sample_weather(prepared, 3; window = window2, transforms = custom)\n(row_custom.T, row_custom.Tmax, row_custom.Tsum)","category":"section"},{"location":"weather-sampling/#5.-Calendar-Window-Sampling","page":"Weather Sampling","title":"5. Calendar Window Sampling","text":"Sometimes model logic is tied to civil periods (day/week/month) rather than fixed trailing windows. In this case, we can use CalendarWindow to aggregate all source steps that fall within the same period. This is useful for e.g. daily models that need to aggregate all hourly steps that fall within the same day, regardless of how many there are or where they fall in the source data. For example if you need the average temperature for the day, you can use a CalendarWindow anchored to the current period:\n\nwindow_day = CalendarWindow(:day)\nday_sample = sample_weather(prepared, 5; window = window_day)\n(day_sample.T, day_sample.Tmin, day_sample.Tmax, day_sample.duration)\n\nWe sample the fifth hour of the series, which falls on the first day. The sampled T is the average of the 24 hourly steps that fall within that day, which matches our expectation for a daily aggregation:\n\nmean(meteo[i].T for i in 1:24)\n\nThe result would be the same for any hour from 1 to 24, since they all fall in the same day:\n\nday_sample2 = sample_weather(prepared, 20; window = window_day)\nday_sample2.T == day_sample.T\n\nThe aggregated results are cached, so repeated calls with the same window and query step will return the same values, and it means that performance will be ensured for long simulation loops with repeated calls:\n\nday_sample_cached = sample_weather(prepared, 6; window = window_day)\nday_sample_cached.T === day_sample.T\n\nThe returned Atmosphere is different though, since the date (and sometimes duration) are different for each query step, even if the aggregated values are the same:\n\nday_sample.date, day_sample_cached.date, day_sample2.date\n\nNote that CalendarWindow expects a date::DateTime column in the weather. By default, it checks for completeness of the period, but you can use completeness = :allow_partial to authorize incomplete periods. This is also faster since it doesn't have to perform checks.","category":"section"},{"location":"weather-sampling/#6.-Precompute-for-Simulation-Loops","page":"Weather Sampling","title":"6. Precompute for Simulation Loops","text":"When running long simulations, you can precompute all sampled weather tables upfront rather than sampling on-demand at each step. This trades a one-time preprocessing cost for faster lookups during the simulation loop. The materialize_weather function returns one sampled table per requested sampling window, allowing efficient access throughout your simulation.\n\nwindows = [window2, window_day]\ntables = materialize_weather(prepared; windows = windows)\n\n(length(tables), length(tables[window2]), tables[window2][3].T ≈ row3.T)\n\nThis is typically the best approach when you perform many simulations with the same weather, e.g. for model calibration, sensitivity analysis, or system optimization.","category":"section"},{"location":"#PlantMeteo","page":"Home","title":"PlantMeteo","text":"(Image: Stable) (Image: Dev) (Image: Build Status) (Image: Coverage)","category":"section"},{"location":"#What-Problem-This-Package-Solves","page":"Home","title":"What Problem This Package Solves","text":"Plant models often consume weather data from very different sources:\n\nstation files with inconsistent column names and units\nAPI data with provider-specific schemas\ntime steps that do not match your model clock (hourly input, daily model, multi-rate simulation)\n\nPlantMeteo gives you a single workflow to standardize, inspect, and aggregate weather data into a structure that downstream plant models can use directly.","category":"section"},{"location":"#What-You-Get","page":"Home","title":"What You Get","text":"A weather table abstraction with TimeStepTable, Weather, and Atmosphere\nFile ingestion and export with read_weather and write_weather\nAPI retrieval through get_weather with the built-in OpenMeteo backend\nA configurable sampler for model-aligned aggregation with prepare_weather_sampler, sample_weather, and materialize_weather","category":"section"},{"location":"#Who-This-Is-For","page":"Home","title":"Who This Is For","text":"model developers who need robust weather preprocessing before simulation\nresearchers combining historical files and forecast APIs\npackage authors who want to plug custom weather providers behind one interface","category":"section"},{"location":"#Documentation-Map","page":"Home","title":"Documentation Map","text":"Start with Getting Started\nContinue with in-depth guides:\nWeather Data Sources\nWeather Sampling\nUse API for full reference","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"From the Julia package REPL, run add PlantMeteo. Then load it with using PlantMeteo.","category":"section"},{"location":"#Projects-Using-PlantMeteo","page":"Home","title":"Projects Using PlantMeteo","text":"PlantSimEngine.jl\nPlantBiophysics.jl\nXPalm","category":"section"},{"location":"API/#API","page":"API","title":"API","text":"","category":"section"},{"location":"API/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"API/#API-documentation","page":"API","title":"API documentation","text":"","category":"section"},{"location":"API/#PlantMeteo.ATMOSPHERE_COMPUTED","page":"API","title":"PlantMeteo.ATMOSPHERE_COMPUTED","text":"ATMOSPHERE_SELECT\n\nList of variables that are by default removed from the table when using write_weather on a TimeStepTable{Atmosphere}.\n\n\n\n\n\n","category":"constant"},{"location":"API/#PlantMeteo.ATMOSPHERE_NONSTANDARD_NAMES","page":"API","title":"PlantMeteo.ATMOSPHERE_NONSTANDARD_NAMES","text":"ATMOSPHERE_NONSTANDARD_NAMES\n\nList of variables that are by default renamed when using write_weather on a  TimeStepTable{Atmosphere}, to be compatible with standard file systems (CSV, databases...).\n\nCₐ => Ca\neₛ => es\nρ => rho\nλ => lambda\nγ => gamma\nε => epsilon\nΔ => Delta\n\nThe reverse procedure is done when reading a file with read_weather.\n\nSee also\n\nstandardize_columns!\n\n\n\n\n\n","category":"constant"},{"location":"API/#PlantMeteo.DEFAULT_OPENMETEO_HOURLY","page":"API","title":"PlantMeteo.DEFAULT_OPENMETEO_HOURLY","text":"DEFAULT_OPENMETEO_HOURLY\n\nDefault variables downloaded for an Open-Meteo forecast. See here for more.\n\n\n\n\n\n","category":"constant"},{"location":"API/#PlantMeteo.OPENMETEO_MODELS","page":"API","title":"PlantMeteo.OPENMETEO_MODELS","text":"OPENMETEO_MODELS\n\nPossible models for the forecast. See here for more details.\n\n\n\n\n\n","category":"constant"},{"location":"API/#PlantMeteo.AbstractAPI","page":"API","title":"PlantMeteo.AbstractAPI","text":"AbstractAPI\n\nAn abstract type for APIs. This is used to define the API to use for the weather forecast. You can get all available APIs using subtype(AbstractAPI).\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.AbstractAtmosphere","page":"API","title":"PlantMeteo.AbstractAtmosphere","text":"Abstract atmospheric conditions type. The suptypes of AbstractAtmosphere should describe the atmospheric conditions for one time-step only, see e.g. Atmosphere\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.AbstractSamplingWindow","page":"API","title":"PlantMeteo.AbstractSamplingWindow","text":"AbstractSamplingWindow\n\nAbstract supertype for weather window selectors used by sample_weather.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.AbstractTimeReducer","page":"API","title":"PlantMeteo.AbstractTimeReducer","text":"AbstractTimeReducer\n\nAbstract supertype for reducers used by MeteoTransform.\n\nReducer implementations are expected to be callable with either:\n\n(vals)\n(vals, durations)\n\nSee MeanWeighted, SumReducer, and RadiationEnergy.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.Atmosphere","page":"API","title":"PlantMeteo.Atmosphere","text":"Atmosphere structure to hold all values related to the meteorology / atmosphere.\n\nArguments\n\ndate<:AbstractDateTime = Dates.now(): the date of the record.\nduration<:Period = Dates.Second(1.0): the duration of the time-step in Dates.Period.\nT (°C): air temperature\nWind (m s-1): wind speed\nRh (0-1): relative humidity (can be computed using rh_from_vpd)\nP = DEFAULTS.P (kPa): air pressure. The default value is at 1 atm, i.e. the mean sea-level\n\natmospheric pressure on Earth.\n\nPrecipitations = DEFAULTS.Precipitations (mm): precipitations from atmosphere (i.e. rain, snow, hail, etc.)\nCₐ = DEFAULTS.Cₐ (ppm): air CO₂ concentration\ncheck = true: whether to check the validity of the input values.\ne = vapor_pressure(T,Rh) (kPa): vapor pressure\neₛ = e_sat(T) (kPa): saturated vapor pressure\nVPD = eₛ - e (kPa): vapor pressure deficit\nρ = air_density(T, P, constants.Rd, constants.K₀) (kg m-3): air density\nλ = latent_heat_vaporization(T, constants.λ₀) (J kg-1): latent heat of vaporization\nγ = psychrometer_constant(P, λ, constants.Cₚ, constants.ε) (kPa K−1): psychrometer \"constant\"\nε = atmosphere_emissivity(T,e,constants.K₀) (0-1): atmosphere emissivity\nΔ = e_sat_slope(meteo.T) (0-1): slope of the saturation vapor pressure at air temperature\nclearness::A = Inf (0-1): Sky clearness\nRi_SW_f::A = Inf (W m-2): Incoming short wave radiation flux\nRi_PAR_f::A = Inf (W m-2): Incoming PAR flux\nRi_NIR_f::A = Inf (W m-2): Incoming NIR flux\nRi_TIR_f::A = Inf (W m-2): Incoming TIR flux\nRi_custom_f::A = Inf (W m-2): Incoming radiation flux for a custom waveband\n\nNotes\n\nThe structure can be built using only T, Rh, Wind and P. All other variables are optional and either let at their default value or automatically computed using the functions given in Arguments.\n\nExamples\n\nAtmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.CalendarWindow","page":"API","title":"PlantMeteo.CalendarWindow","text":"CalendarWindow(period; anchor=:current_period, week_start=1, completeness=:allow_partial)\n\nCalendar-based window selector used by sample_weather.\n\nArguments\n\nperiod::Symbol: grouping period.\n:day: group by civil day.\n:week: group by civil week (start controlled by week_start).\n:month: group by calendar month.\nanchor::Symbol: which period is sampled at weather step i.\n:current_period: sample from the period containing weather[i].date.\n:previous_complete_period: sample from the period immediately before the current one.\nweek_start::Int: week start day in 1:7 (1=Monday, 7=Sunday). Used only when period == :week.\ncompleteness::Symbol: behavior when selected period is missing/incomplete.\n:allow_partial: accept partial periods; if no previous period exists, fallback to [step].\n:strict: require a valid complete selected period (default); otherwise throw an error.\n\nNotes\n\nCalendarWindow requires date::DateTime in source weather rows.\nCompleteness is checked from summed duration against expected civil period duration.\n\nErrors\n\nThrows if any argument is outside the allowed set.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.Constants","page":"API","title":"PlantMeteo.Constants","text":"Physical constants\n\nThe definition and default values are:\n\nK₀ = -273.15: absolute zero (°C)\nR = 8.314: universal gas constant (J mol^-1 K^-1).\nRd = 287.0586: gas constant of dry air (J kg^-1 K^-1).\nDₕ₀ = 21.5e-6: molecular diffusivity for heat at base temperature, applied in the integrated form of the   Fick’s Law of diffusion (m^2 s^-1). See eq. 3.10 from Monteith and Unsworth (2013).\nCₚ = 1013.0: Specific heat of air at constant pressure (J K^-1 kg^-1), also   known as efficiency of impaction of particles. See Allen et al. (1998), or Monteith and   Unsworth (2013). NB: bigleaf R package uses 1004.834 intead.\nε = 0.622: ratio of molecular weights of water vapor and air. See Monteith and   Unsworth (2013).\nλ₀ = 2.501: latent heat of vaporization for water at 0 degree (J kg^-1).\nσ = 5.670373e-08 Stefan-Boltzmann constant   in (W m^-2 K^-4).\nGbₕ_to_Gbₕ₂ₒ = 1.075: conversion coefficient from conductance to heat to conductance to water   vapor.\nGsc_to_Gsw = 1.57: conversion coefficient from stomatal conductance to CO₂ to conductance to water   vapor.\nGbc_to_Gbₕ = 1.32: conversion coefficient from boundary layer conductance to CO₂ to heat.\nMₕ₂ₒ = 18.0e-3 (kg mol-1): Molar mass for water.\nJ_to_umol = 4.57: Conversion factor from radiation in Joules m-2 s-1 (or W m-2) to μmol m-2 s-1.\nPAR_fraction = 0.48: Fraction of shortwave radiation that is photosynthetically active radiation (PAR).\n\nReferences\n\nAllen, Richard G., Luis S. Pereira, Dirk Raes, et Martin J Fao Smith. 1998. « Crop evapotranspiration-Guidelines for computing crop water requirements-FAO Irrigation and drainage paper 56 » 300 (9): D05109.\n\nMonteith, John, et Mike Unsworth. 2013. Principles of environmental physics: plants, animals, and the atmosphere. Academic Press.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.FirstReducer","page":"API","title":"PlantMeteo.FirstReducer","text":"FirstReducer()\n\nReducer returning first value in the window.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.FirstReducer-Tuple{AbstractVector}","page":"API","title":"PlantMeteo.FirstReducer","text":"(FirstReducer())(vals)\n(FirstReducer())(vals, durations)\n\nReturn first sampled value.\n\nArguments\n\nvals::AbstractVector: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.LastReducer","page":"API","title":"PlantMeteo.LastReducer","text":"LastReducer()\n\nReducer returning last value in the window.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.LastReducer-Tuple{AbstractVector}","page":"API","title":"PlantMeteo.LastReducer","text":"(LastReducer())(vals)\n(LastReducer())(vals, durations)\n\nReturn last sampled value.\n\nArguments\n\nvals::AbstractVector: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.MaxReducer","page":"API","title":"PlantMeteo.MaxReducer","text":"MaxReducer()\n\nMaximum reducer.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.MaxReducer-Tuple{AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.MaxReducer","text":"(MaxReducer())(vals)\n(MaxReducer())(vals, durations)\n\nCompute maximum of sampled values.\n\nArguments\n\nvals::AbstractVector{<:Real}: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.MeanReducer","page":"API","title":"PlantMeteo.MeanReducer","text":"MeanReducer()\n\nArithmetic mean reducer.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.MeanReducer-Tuple{AbstractVector{<:Real}, AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.MeanReducer","text":"(MeanReducer())(vals)\n(MeanReducer())(vals, durations)\n\nCompute arithmetic mean of sampled values.\n\nArguments\n\nvals::AbstractVector{<:Real}: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.MeanWeighted","page":"API","title":"PlantMeteo.MeanWeighted","text":"MeanWeighted()\n\nDuration-weighted mean reducer. When durations are not provided, falls back to a plain mean.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.MeanWeighted-Tuple{AbstractVector{<:Real}, AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.MeanWeighted","text":"(MeanWeighted())(vals, durations)\n\nCompute duration-weighted mean.\n\nArguments\n\nvals::AbstractVector{<:Real}: values to reduce.\ndurations::AbstractVector{<:Real}: per-value durations.\n\nReturns\n\nWeighted mean, or nothing when the total duration is zero.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.MeteoTransform","page":"API","title":"PlantMeteo.MeteoTransform","text":"MeteoTransform(target; source=target, reducer=MeanWeighted())\n\nBuild a transform rule consumed by sample_weather.\n\nArguments\n\ntarget::Symbol: output variable name in sampled weather.\nsource::Symbol: input variable name read from source rows.\nreducer: reducer instance used on windowed values.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.MinReducer","page":"API","title":"PlantMeteo.MinReducer","text":"MinReducer()\n\nMinimum reducer.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.MinReducer-Tuple{AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.MinReducer","text":"(MinReducer())(vals)\n(MinReducer())(vals, durations)\n\nCompute minimum of sampled values.\n\nArguments\n\nvals::AbstractVector{<:Real}: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.OpenMeteo","page":"API","title":"PlantMeteo.OpenMeteo","text":"OpenMeteo()\nOpenMeteo(\n    vars=PlantMeteo.DEFAULT_OPENMETEO_HOURLY,\n    forecast_server=\"https://api.open-meteo.com/v1/forecast\",\n    historical_server=\"https://archive-api.open-meteo.com/v1/era5\",\n    units=OpenMeteoUnits(),\n    timezone=\"UTC\",\n    models=[\"auto\"]\n)\n\nA type that defines the open-meteo.com API.  No need of an API key as it is free. Please keep in mind that the API is distributed under the AGPL license, that it is not free for commercial use, and that you should use it responsibly.\n\nNotes\n\nThe API wrapper provided by PlantMeteo is only working for the hourly data as daily data is missing  some variables. The API wrapper is also not working for the \"soil\" variables as they are not consistant between forecast and historical data.\n\nSee also\n\nto_daily\n\nArguments\n\nvars: the variables needed, see here.\nforecast_server: the server to use for the forecast, see \n\nhere. Default to https://api.open-meteo.com/v1/forecast.\n\nhistorical_server: the server to use for the historical data, see \n\nhere. Default to https://archive-api.open-meteo.com/v1/era5.\n\nstart_archive::Dates.Day: the first day on which we have to get data from the historical archive instead of the forecast server, \n\ndata is at 25km resolution in the archive. Default to -150 days.\n\nunits::OpenMeteoUnits: the units used for the variables, see OpenMeteoUnits.\ntimezone: the timezone used for the data, see the list here. \n\nDefault to \"UTC\". This parameter is not checked, so be careful when using it.\n\nmodels: the models to use for the forecast. Default to \"[\"best_match\"]\". See OPENMETEO_MODELS for more details.\n\nTroubleshooting\n\nIf you get an error when calling the API, try to decrease the value of start_archive to e.g.. 100 days before  today (-Dates.Day(100)).\n\nDetails\n\nThe default variables are: \"temperature2m\", \"relativehumidity2m\", \"precipitation\", \"surfacepressure\", \"windspeed10m\", \"shortwaveradiation\", \"directradiation\", \"diffuse_radiation\".\n\nNote that we don't download: \"soiltemperature0cm\", \"soiltemperature6cm\", \"soiltemperature18cm\", \"soiltemperature54cm\", \"soilmoisture01cm\", \"soilmoisture13cm\", \"soilmoisture39cm\", \"soilmoisture927cm\" and \"soilmoisture27_81cm\"  by default as they are not consistant between forecast and hystorical data.\n\nSources\n\nOpen-Meteo.com, under Attribution \n\n4.0 International (CC BY 4.0).\n\nCopernicus Climate Change Service information 2022 (Hersbach et al., 2018).\n\nHersbach, H., Bell, B., Berrisford, P., Biavati, G., Horányi, A., Muñoz Sabater, J., Nicolas, J.,  Peubey, C., Radu, R., Rozum, I., Schepers, D., Simmons, A., Soci, C., Dee, D., Thépaut, J-N. (2018):  ERA5 hourly data on single levels from 1959 to present.  Copernicus Climate Change Service (C3S) Climate Data Store (CDS). (Updated daily), 10.24381/cds.adbb2d47\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.OpenMeteoUnits","page":"API","title":"PlantMeteo.OpenMeteoUnits","text":"OpenMeteoUnits(temperature_unit, windspeed_unit, precipitation_unit)\nOpenMeteoUnits(;temperature_unit=\"celsius\", windspeed_unit=\"ms\", precipitation_unit=\"mm\")\n\nA type that defines the units used for the variabels when calling the open-meteo.com API.\n\nArguments\n\ntemperature_unit: the temperature unit, can be \"celsius\" or \"fahrenheit\". Default to \"celsius\".\nwindspeed_unit: the windspeed unit, can be \"ms\", \"kmh\", \"mph\", or \"kn\". Default to \"ms\".\nprecipitation_unit: the precipitation unit, can be \"mm\" or \"inch\". Default to \"mm\".\n\nExamples\n\njulia> units = OpenMeteoUnits(\"celsius\", \"ms\", \"mm\")\nOpenMeteoUnits(\"celsius\", \"ms\", \"mm\")\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.PreparedWeather","page":"API","title":"PlantMeteo.PreparedWeather","text":"PreparedWeather(weather; transforms=default_sampling_transforms(), lazy=true)\n\nBuild a sampler container used by sample_weather.\n\nArguments\n\nweather: source weather table (TimeStepTable{Atmosphere} or compatible rows).\ntransforms: transform specification accepted by normalize_sampling_transforms.\nlazy::Bool: enable memoization cache for repeated sampling queries.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.RadiationEnergy","page":"API","title":"PlantMeteo.RadiationEnergy","text":"RadiationEnergy()\n\nIntegrate flux values (W m-2) over durations (seconds) into MJ m-2.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.RadiationEnergy-Tuple{AbstractVector{<:Real}, AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.RadiationEnergy","text":"RadiationEnergy()(vals, durations)\n\nIntegrate flux values over durations into energy in MJ m-2.\n\nArguments\n\nvals::AbstractVector{<:Real}: flux values in W m-2.\ndurations::AbstractVector{<:Real}: durations in seconds or in Dates.TimePeriod (e.g. Dates.Day, Dates.Minute...).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.RadiationEnergy-Tuple{AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.RadiationEnergy","text":"(RadiationEnergy())(vals)\n\nErroring fallback for duration-free reductions.\n\nUse (RadiationEnergy())(vals, durations) in weather sampling contexts.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.RollingWindow","page":"API","title":"PlantMeteo.RollingWindow","text":"RollingWindow(dt=1.0)\n\nTrailing window selector for sample_weather.\n\nArguments\n\ndt::Real: trailing window length in source weather timesteps.\n\nNotes\n\nRollingWindow() is equivalent to RollingWindow(1.0) (identity window).\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.SumReducer","page":"API","title":"PlantMeteo.SumReducer","text":"SumReducer()\n\nSum reducer.\n\n\n\n\n\n","category":"type"},{"location":"API/#PlantMeteo.SumReducer-Tuple{AbstractVector{<:Real}}","page":"API","title":"PlantMeteo.SumReducer","text":"(SumReducer())(vals)\n(SumReducer())(vals, durations)\n\nCompute sum of sampled values.\n\nArguments\n\nvals::AbstractVector{<:Real}: values to reduce.\ndurations::AbstractVector{<:Real}: optional durations (ignored).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.TimeStepTable","page":"API","title":"PlantMeteo.TimeStepTable","text":"TimeStepTable(vars)\n\nTimeStepTable stores variables values for each time step, e.g. weather variables. It implements the Tables.jl interface, so it can be used with any package that uses  Tables.jl (like DataFrames.jl).\n\nYou can extend TimeStepTable to store your own variables by defining a new type for the  storage of the variables. You can look at the Atmosphere type  for an example implementation, or the Status type from  PlantSimEngine.jl.\n\nExamples\n\ndata = TimeStepTable(\n    [\n        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),\n        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),\n        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)\n    ]\n)\n\n# We can convert it into a DataFrame:\nusing DataFrames\ndf = DataFrame(data)\n\n# We can also create a TimeStepTable from a DataFrame:\nTimeStepTable(df)\n\n# Note that by default it will use NamedTuple to store the variables\n# for high performance. If you want to use a different type, you can\n# specify it as a type parameter (if you want *e.g.* mutability or pre-computations):\nTimeStepTable{Atmosphere}(df)\n# Or if you use PlantSimEngine: TimeStepTable{Status}(df)\n\n# Indexing examples:\ndata[:T]      # full column by Symbol\ndata[\"T\"]     # full column by String\ndata[1]       # one row\ndata[1:2]     # row subset as TimeStepTable\ndata[1, :]    # one row (matrix-like syntax)\ndata[1, :T]   # one cell by row + Symbol column\ndata[1, \"T\"]  # one cell by row + String column\ndata[1:2, :T] # vector slice from one column\ndata[1:2, \"T\"]\n\n\n\n\n\n","category":"type"},{"location":"API/#Base.getproperty-Tuple{PlantMeteo.TimeStepRow, Symbol}","page":"API","title":"Base.getproperty","text":"Tables.getcolumn(row::TimeStepRow, nm::Symbol)\nTables.getcolumn(row::TimeStepRow, nm::Int)\n\nGet the value of a variable in a TimeStepRow object.\n\n\n\n\n\n","category":"method"},{"location":"API/#Base.setindex!-Tuple{PlantMeteo.TimeStepRow, Any, Any}","page":"API","title":"Base.setindex!","text":"setindex!(row::TimeStepRow, nm::Symbol)\nsetindex!(row::TimeStepRow, i::Int)\n\nSet the value of a variable in a TimeStepRow object.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.Weather-Union{Tuple{Any}, Tuple{S}, Tuple{Any, S}} where S<:NamedTuple","page":"API","title":"PlantMeteo.Weather","text":"Weather(data[, metadata])\n\nDefines the weather, i.e. the local conditions of the Atmosphere for one or more time-steps. Each time-step is described using the Atmosphere structure, and the resulting structure is a TimeStepTable.\n\nThe simplest way to instantiate a Weather is to use a DataFrame as input.\n\nThe DataFrame should be formated such as each row is an observation for a given time-step and each column is a variable. The column names should match exactly the variables names of the Atmosphere structure:\n\nSee also\n\nthe Atmosphere structure\nthe read_weather function to read Archimed-formatted meteorology data.\n\nExamples\n\nExample of weather data defined by hand (cumbersome):\n\nw = Weather(\n    [\n        Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65),\n        Atmosphere(T = 23.0, Wind = 1.5, P = 101.3, Rh = 0.60),\n        Atmosphere(T = 25.0, Wind = 3.0, P = 101.3, Rh = 0.55)\n    ],\n    (\n        site = \"Test site\",\n        important_metadata = \"this is important and will be attached to our weather data\"\n    )\n)\n\nWeather is a TimeStepTable{Atmosphere}, so we can convert it into a DataFrame:\n\nusing DataFrames\ndf = DataFrame(w)\n\nAnd then back into Weather to make a TimeStepTable{Atmosphere}:\n\nWeather(df, (site = \"My site\",))\n\nOf course it works with any DataFrame that has at least the required variables listed in Atmosphere.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._build_calendar_window_cache-Tuple{PreparedWeather, CalendarWindow}","page":"API","title":"PlantMeteo._build_calendar_window_cache","text":"_build_calendar_window_cache(prepared, window)\n\nPrecompute per-step indices and completeness flags for CalendarWindow sampling.\n\nArguments\n\nprepared::PreparedWeather: source weather container.\nwindow::CalendarWindow: calendar window settings.\n\nReturns\n\nNamed tuple with:\n\nindices_by_step::Vector{Vector{Int}}\ncomplete_by_step::Vector{Bool}\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._default_radiation_flux_vars-Tuple{}","page":"API","title":"PlantMeteo._default_radiation_flux_vars","text":"_default_radiation_flux_vars()\n\nReturn default radiation source variable names used by default_sampling_transforms.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._duration_period_from_seconds-Tuple{Float64}","page":"API","title":"PlantMeteo._duration_period_from_seconds","text":"_duration_period_from_seconds(sec)\n\nConvert seconds to a Dates.Millisecond period used in sampled outputs.\n\nArguments\n\nsec::Float64: duration in seconds.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._duration_seconds-Tuple{Any}","page":"API","title":"PlantMeteo._duration_seconds","text":"_duration_seconds(d)\n\nConvert a duration-like value to seconds.\n\nArguments\n\nd: a Dates.Period, a real value already in seconds, or another value.\n\nReturns\n\nFloat64 seconds. Unknown types fall back to 1.0.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._expected_period_seconds-Tuple{Date, CalendarWindow}","page":"API","title":"PlantMeteo._expected_period_seconds","text":"_expected_period_seconds(period_key, window)\n\nReturn expected duration in seconds for a complete calendar period.\n\nArguments\n\nperiod_key::Dates.Date: canonical period key from _period_key.\nwindow::CalendarWindow: window configuration.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._normalize_reducer-Tuple{Any}","page":"API","title":"PlantMeteo._normalize_reducer","text":"_normalize_reducer(reducer)\n\nNormalize user reducer definitions into a callable reducer object.\n\nArguments\n\nreducer: reducer instance/type or callable.\n\nReturns\n\nReducer instance when input is a reducer type.\nReducer/callable unchanged when already instantiated.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._normalize_single_transform-Tuple{Symbol, Any}","page":"API","title":"PlantMeteo._normalize_single_transform","text":"_normalize_single_transform(target, rule)\n\nNormalize one transform specification entry into a MeteoTransform.\n\nArguments\n\ntarget::Symbol: output variable name.\nrule: reducer-like value or named tuple with optional source and reducer.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._period_key-Tuple{DateTime, CalendarWindow}","page":"API","title":"PlantMeteo._period_key","text":"_period_key(dt, window)\n\nMap a DateTime to the canonical period key used by CalendarWindow.\n\nArguments\n\ndt::Dates.DateTime: timestamp to classify.\nwindow::CalendarWindow: window configuration (day/week/month).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._reduce_values-Tuple{AbstractVector, AbstractVector{<:Real}, Any}","page":"API","title":"PlantMeteo._reduce_values","text":"_reduce_values(vals, durations, reducer)\n\nApply one reducer to sampled values and optional durations.\n\nArguments\n\nvals::AbstractVector: sampled source values for one transform.\ndurations::AbstractVector{<:Real}: per-value durations in seconds.\nreducer: normalized reducer instance or callable.\n\nReturns\n\nReduced value, or nothing when reduction is not possible (for example non-real values with real-only reducers).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._sample_weather_uncached-Tuple{PreparedWeather, Int64, AbstractSamplingWindow, AbstractVector{MeteoTransform}}","page":"API","title":"PlantMeteo._sample_weather_uncached","text":"_sample_weather_uncached(prepared, step, window, transforms)\n\nCompute one sampled weather row without using/setting cache.\n\nArguments\n\nprepared::PreparedWeather: source weather container.\nstep::Int: index of the current source weather row.\nwindow::AbstractSamplingWindow: window selection strategy.\ntransforms::AbstractVector{MeteoTransform}: normalized transform rules.\n\nReturns\n\nAtmosphere sampled at step.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._transform_signature-Tuple{AbstractVector{MeteoTransform}}","page":"API","title":"PlantMeteo._transform_signature","text":"_transform_signature(transforms)\n\nCompute a deterministic hash signature for transform rules used in cache keys.\n\nArguments\n\ntransforms::AbstractVector{MeteoTransform}: normalized transform rules.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._week_start_date-Tuple{Date, Int64}","page":"API","title":"PlantMeteo._week_start_date","text":"_week_start_date(d, week_start)\n\nReturn the civil week start date containing d.\n\nArguments\n\nd::Dates.Date: date to classify.\nweek_start::Int: week start day in 1:7 (1=Monday, 7=Sunday).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._window_bounds-Tuple{Int64, RollingWindow}","page":"API","title":"PlantMeteo._window_bounds","text":"_window_bounds(step, window)\n\nCompute inclusive trailing bounds (start, stop) for a RollingWindow.\n\nArguments\n\nstep::Int: current weather index.\nwindow::RollingWindow: rolling window configuration.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo._window_indices-Tuple{PreparedWeather, Int64, AbstractSamplingWindow}","page":"API","title":"PlantMeteo._window_indices","text":"_window_indices(prepared, step, window)\n\nReturn source weather indices selected for one sampling query.\n\nArguments\n\nprepared::PreparedWeather: source weather container.\nstep::Int: current weather index.\nwindow::AbstractSamplingWindow: window selection strategy.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.add_transformations!-NTuple{4, Any}","page":"API","title":"PlantMeteo.add_transformations!","text":"add_transformations!(df, trans, vars, fun; error_missing=false)\n\nAdd the fun transformations to the trans vector for the  variables vars found in the df DataFrame.\n\nArguments\n\ndf: the DataFrame\ntrans: the vector of transformations (will be modified in-place)\nvars: the variables to transform (can be a symbol, a vector of symbols or a pairs :var => :new_var)\nfun: the function to apply to the variables\nerror_missing=true: if true, the function returns an error if the variable is not found. If false, \n\nthe variable is not added to trans.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.air_density-NTuple{4, Any}","page":"API","title":"PlantMeteo.air_density","text":"air_density(Tₐ, P; check=true)\nair_density(Tₐ, P, Rd, K₀; check=true)\n\nρ, the air density (kg m-3).\n\nArguments\n\nTₐ (Celsius degree): air temperature\nP (kPa): air pressure\nRd (J kg-1 K-1): gas constant of dry air (see Foken p. 245, or R bigleaf package).\nK₀ (Celsius degree): temperature in Celsius degree at 0 Kelvin\ncheck (Bool): check if P is in the 85-110 kPa earth range\n\nNote\n\nRd and K₀ are Taken from Constants if not provided.\n\nReferences\n\nFoken, T, 2008: Micrometeorology. Springer, Berlin, Germany.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.atmosphere_emissivity-Tuple{Any, Any, Any}","page":"API","title":"PlantMeteo.atmosphere_emissivity","text":"atmosphere_emissivity(Tₐ,eₐ)\n\nEmissivity of the atmoshpere at a given temperature and vapor pressure.\n\nArguments\n\nTₐ (°C): air temperature\neₐ (kPa): air vapor pressure\nK₀ (°C): absolute zero\n\nExamples\n\nTₐ = 20.0\nVPD = 1.5\natmosphere_emissivity(Tₐ, vapor_pressure(Tₐ,VPD))\n\nReferences\n\nLeuning, R., F. M. Kelliher, DGG de Pury, et E.-D. SCHULZE. 1995. Leaf nitrogen, photosynthesis, conductance and transpiration: scaling from leaves to canopies ». Plant, Cell & Environment 18 (10): 1183‑1200.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.check_day_complete-Tuple{Any}","page":"API","title":"PlantMeteo.check_day_complete","text":"check_day_complete(df)\n\nCheck that the weather table df has full days (24h) of data by  summing their durations.\n\ndf must be a Tables.jl compatible table with a date and duration column. The date column must be a Dates.DateTime column, and the duration column  must be a Dates.Period or Dates.CompoundPeriod column.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.compute_date","page":"API","title":"PlantMeteo.compute_date","text":"compute_date(data, date_format, hour_format)\n\nCompute the date column depending on several cases:\n\nIf it is already in data and is a DateTime, does nothing.\nIf it is a String, tries and parse it using a user-input DateFormat\nIf it is a Date, return it as is, or try to make it a DateTime if there's a column named\n\nhour_start\n\nArguments\n\ndata: any Tables.jl compatible table, such as a DataFrame\ndate_format: a DateFormat to parse the date column if it is a String\nhour_format: a DateFormat to parse the hour_start column if it is a String\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.compute_duration","page":"API","title":"PlantMeteo.compute_duration","text":"compute_duration(data, hour_format, duration)\n\nCompute the duration column depending on several cases:\n\nIf it is already in the data, use the duration function to parse it into a Date.Period.\nIf it is not, but there's a column named hour_end and another one either called hour_start\n\nor date, compute the duration from the period between hour_start (or date) and hour_end.\n\nArguments\n\ndata: any Tables.jl compatible table, such as a DataFrame\nhour_format: a DateFormat to parse the hour_start and hour_end columns if they are Strings.\nduration: a function to parse the duration column. Usually Dates.Day or Dates.Minute.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.default_sampling_transforms-Tuple{}","page":"API","title":"PlantMeteo.default_sampling_transforms","text":"default_sampling_transforms(; radiation_mode=:both)\n\nDefault weather sampling rules.\n\nradiation_mode controls how radiation targets are emitted:\n\n:flux_mean: duration-weighted mean flux (same units as source)\n:energy_sum: integrated quantity in MJ m-2 over the sampling window\n:both: keep Ri_*_f as weighted-mean flux and also emit Ri_*_q quantities\n\nArguments\n\nradiation_mode::Symbol: one of :flux_mean, :energy_sum, :both.\n\nReturns\n\nVector{MeteoTransform} used by PreparedWeather and sample_weather.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.default_transformation-Tuple{Any}","page":"API","title":"PlantMeteo.default_transformation","text":"default_transformation(df)\n\nReturn the default transformations to apply to the df DataFrame  for the to_daily function. If the variable is not available, the transformation is not applied.\n\nThe default transformations are:\n\n:date => (x -> unique(Dates.Date.(x))) => :date: the date is transformed into a Date object\n:duration => sum => :duration: the duration is summed\n:T => minimum => :Tmin: we use the minimum temperature for Tmin\n:T => maximum => :Tmax: and the maximum temperature for Tmax\n:T => mean => :T: and the average daily temperature (!= than average of Tmin and Tmax)\n:Precipitations => sum => :Precipitations: the precipitations are summed\n:Rh => mean => :Rh: the relative humidity is averaged\n:Wind, :P, :Rh, :Cₐ, :e, :eₛ, :VPD, :ρ, :λ, :γ, :ε, :Δ, :clearness are \n\nall averaged\n\n[:Ri_SW_f, :duration] => ((x, y) -> sum(x .* Dates.toms.(y)) * 1.0e-9) => :Ri_SW_f: the irradiance is integrated, so its unit changes from W m⁻² to MJ m⁻² d⁻¹\nAll other irradiance variables are also integrated (see the code for details)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.e_sat-Tuple{Any}","page":"API","title":"PlantMeteo.e_sat","text":"e_sat(T)\n\nSaturated water vapour pressure (es, in kPa) at given temperature T (°C). See Jones (1992) p. 110 for the equation.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.e_sat_slope-Tuple{Any}","page":"API","title":"PlantMeteo.e_sat_slope","text":"e_sat_slope(T)\n\nSlope of the vapor pressure saturation curve at a given temperature T (°C).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.fetch_openmeteo-Union{Tuple{T}, Tuple{Any, Any, Any, Any, Any, T}} where T<:OpenMeteo","page":"API","title":"PlantMeteo.fetch_openmeteo","text":"fetch_openmeteo(url, lat, lon, start_date, end_date, params::OpenMeteo)\n\nFetches the weather forecast from OpenMeteo.com and returns a tuple of: \n\na vector of Atmosphere\na NamedTuple of metadata (e.g. elevation, timezone, units...)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.format_openmeteo!-Tuple{Any}","page":"API","title":"PlantMeteo.format_openmeteo!","text":"format_openmeteo(data)\n\nFormat the JSON file returned by the Open-Meteo API into a vector  of Atmosphere. The function also updates some units in data.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.get_forecast-Tuple{OpenMeteo, Any, Any, Any}","page":"API","title":"PlantMeteo.get_forecast","text":"get_forecast(params::OpenMeteo, lat, lon, period; verbose=true)\n\nA function that returns the weather forecast from OpenMeteo.com\n\nArguments\n\nlat: Latitude of the location\nlon: Longitude of the location\nperiod::Union{StepRange{Date, Day}, Vector{Dates.Date}}: Period of the forecast\nverbose: If true, print more information in case of errors or warnings.\nkwargs: Additional keyword arguments passed to get_forecast (not used in this method).\n\nExamples\n\nusing PlantMeteo, Dates\nlat = 48.8566\nlon = 2.3522\nperiod = [Dates.today(), Dates.today()+Dates.Day(3)]\nparams = OpenMeteo()\nget_forecast(params, lat, lon, period)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.get_index_raw-Tuple{TimeStepTable, Integer}","page":"API","title":"PlantMeteo.get_index_raw","text":"Get row from TimeStepTable in its raw format, e.g. as a NamedTuple or Atmosphere of values.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.get_weather-Union{Tuple{P}, Tuple{Any, Any, P}} where P<:Union{StepRange{Date, Day}, Vector{Date}}","page":"API","title":"PlantMeteo.get_weather","text":"get_weather(lat, lon, period::Union{StepRange{Date, Day}, Vector{Dates.Date}}; api::DataType=OpenMeteo, sink=TimeStepTable, kwargs...)\n\nReturns the weather forecast for a given location and time using a weather API.\n\nArguments\n\nlat::Float64: Latitude of the location in degrees\nlon::Float64: Longitude of the location in degrees\nperiod::Union{StepRange{Date, Day}, Vector{Dates.Date}}: Period of the forecast\napi::DataType=OpenMeteo: API to use for the forecast.\nsink::DataType=TimeStepTable: Type of the output. Default is TimeStepTable, but it\n\ncan be any type that implements the Tables.jl interface, such as DataFrames.\n\nkwargs...: Additional keyword arguments that are passed to the API\n\nDetails\n\nWe can get all available APIs using subtype(AbstractAPI). Please keep in mind that the default OpenMeteo API is not free for commercial use, and that you should use it responsibly.\n\nExamples\n\nusing PlantMeteo, Dates\n# Forecast for today and tomorrow:\nperiod = [today(), today()+Dates.Day(1)]\nw = get_weather(48.8566, 2.3522, period)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.latent_heat_vaporization-Tuple{Any, Any}","page":"API","title":"PlantMeteo.latent_heat_vaporization","text":"latent_heat_vaporization(Tₐ,λ₀)\nlatent_heat_vaporization(Tₐ)\n\nλ, the latent heat of vaporization for water (J kg-1).\n\nArguments\n\nTₐ (°C): air temperature\nλ₀: latent heat of vaporization for water at 0 degree Celsius. Taken from Constants().λ₀\n\nif not provided (see Constants).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.materialize_weather-Tuple{PreparedWeather}","page":"API","title":"PlantMeteo.materialize_weather","text":"materialize_weather(prepared; windows, transforms=nothing)\n\nPrecompute sampled weather tables for a set of sampling windows. Returns Dict{AbstractSamplingWindow,TimeStepTable{Atmosphere}}.\n\nArguments\n\nprepared::PreparedWeather: sampler state containing source weather.\nwindows: iterable collection of AbstractSamplingWindow.\ntransforms: optional transform override applied to all windows.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.new_names-Tuple{Any}","page":"API","title":"PlantMeteo.new_names","text":"new_names(args)\n\nGet the new names of the columns after the transformation provided  by the user.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.next_row","page":"API","title":"PlantMeteo.next_row","text":"next_row(row::TimeStepRow, i=1)\n\nReturn the next row in the table.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.next_value","page":"API","title":"PlantMeteo.next_value","text":"next_value(row::TimeStepRow, var, next_index=1; default=nothing)\n\nReturn the value of var in the next row in the table, or default if there is no next row.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.normalize_sampling_transforms-Tuple{AbstractVector{MeteoTransform}}","page":"API","title":"PlantMeteo.normalize_sampling_transforms","text":"normalize_sampling_transforms(transforms)\n\nNormalize user-provided weather transform definitions into Vector{MeteoTransform}.\n\nAccepted inputs are:\n\nVector{MeteoTransform} (copied as-is)\nNamedTuple where each key is the target variable and each value is either:\na reducer (AbstractTimeReducer instance/type, or callable), or\na named tuple with optional source and reducer fields\nAbstractVector containing only MeteoTransform entries\n\nThis is the canonical parser used by PreparedWeather and sample_weather to validate and materialize transform rules.\n\nArguments\n\ntransforms: user transform specification (named tuple or vector forms).\n\nReturns\n\nVector{MeteoTransform}.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.parse_hour","page":"API","title":"PlantMeteo.parse_hour","text":"parse_hour(h, hour_format=Dates.DateFormat(\"HH:MM:SS\"))\n\nParse an hour that can be of several formats:\n\nTime: return it as is\nString: try to parse it using the user-input DateFormat\nDateTime: transform it into a Time\n\nArguments\n\nh: hour to parse\nhour_format::DateFormat: user-input format to parse the hours\n\nExamples\n\njulia> using PlantMeteo, Dates;\n\nAs a string:\n\njulia> PlantMeteo.parse_hour(\"12:00:00\")\n12:00:00\n\nAs a Time:\n\njulia> PlantMeteo.parse_hour(Dates.Time(12, 0, 0))\n12:00:00\n\nAs a DateTime:\n\njulia> PlantMeteo.parse_hour(Dates.DateTime(2020, 1, 1, 12, 0, 0))\n12:00:00\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.prepare_weather-Tuple{Any}","page":"API","title":"PlantMeteo.prepare_weather","text":"prepare_weather(\n    w;\n    vars=setdiff(propertynames(w), ATMOSPHERE_COMPUTED),\n    duration=Dates.Minute\n)\n\nPrepare the weather data for writing to a file. The function returns a  DataFrame with the selected variables and the duration formated.\n\nArguments\n\nw: a Tables.jl interfaced table, such as a TimeStepTable{Atmosphere} or a DataFrame\nvars: a vector of variables to write (as symbols). By default, all variables are written except the ones that\n\ncan be recomputed (see ATMOSPHERE_COMPUTED). If nothing is given, all variables are written.\n\nduration: the unit for formating the duration of the time steps. By default, it is Dates.Minute\n\nExamples\n\nusing PlantMeteo, Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))),\"test\",\"data\",\"meteo.csv\")\nw = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\ndf = prepare_weather(w)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.prepare_weather_sampler-Tuple{Any}","page":"API","title":"PlantMeteo.prepare_weather_sampler","text":"prepare_weather_sampler(weather; transforms=default_sampling_transforms(), lazy=true)\n\nBuild the PreparedWeather container holding a fine-step weather table and lazy sampling cache.\n\nArguments\n\nweather: source weather table.\ntransforms: transform specification accepted by normalize_sampling_transforms.\nlazy::Bool: enable/disable sampling cache.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.prev_row","page":"API","title":"PlantMeteo.prev_row","text":"prev_row(row::TimeStepRow, i=1)\n\nReturn the previous row in the table, or default if there is no previous row.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.prev_value","page":"API","title":"PlantMeteo.prev_value","text":"prev_value(row::TimeStepRow, var, prev_index=1; default=nothing)\n\nReturn the value of var in the previous row in the table, or default if there is no previous row.\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.psychrometer_constant-NTuple{4, Any}","page":"API","title":"PlantMeteo.psychrometer_constant","text":"psychrometer_constant(P, λ, Cₚ, ε; check=true)\npsychrometer_constant(P, λ; check=true)\n\nγ, the psychrometer constant, also called psychrometric constant (kPa K−1). See Monteith and Unsworth (2013), p. 222.\n\nArguments\n\nP (kPa): air pressure\nλ (J kg^-1): latent heat of vaporization for water (see latent_heat_vaporization)\nCₚ (J kg-1 K-1): specific heat of air at constant pressure (J K^-1 kg^-1)\nε (Celsius degree): temperature in Celsius degree at 0 Kelvin\ncheck (Bool): check if P is in the 85-110 kPa earth range\n\nNote\n\nCₚ, ε and λ₀ are taken from Constants if not provided.\n\nTₐ = 20.0\n\nλ = latent_heat_vaporization(Tₐ, λ₀)\npsychrometer_constant(100.0, λ)\n\nReferences\n\nMonteith, John L., et Mike H. Unsworth. 2013. « Chapter 13 - Steady-State Heat Balance: (i) Water Surfaces, Soil, and Vegetation ». In Principles of Environmental Physics (Fourth Edition), edited by John L. Monteith et Mike H. Unsworth, 217‑47. Boston: Academic Press.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.read_weather-Tuple{Any, Vararg{Any}}","page":"API","title":"PlantMeteo.read_weather","text":"read_weather(\n    file[,args...];\n    date_format = DateFormat(\"yyyy-mm-ddTHH:MM:SS.s\"),\n    hour_format = DateFormat(\"HH:MM:SS\"),\n    duration=nothing\n)\n\nRead a meteo file. The meteo file is a CSV, and optionnaly with metadata in a header formatted as a commented YAML. The column names and units should match exactly the fields of Atmosphere, or  the user should provide their transformation as arguments (args) with the DataFrames.jl form, i.e.: \n\n:var_name => (x -> x .+ 1) => :new_name: the variable :var_name is transformed by the function    x -> x .+ 1 and renamed to :new_name\n:var_name => :new_name: the variable :var_name is renamed to :new_name\n:var_name: the variable :var_name is kept as is\n\nNote\n\nThe variables found in the file will be used as is if not transformed, and not recomputed from the other variables. Please check that all variables have the same units as in the Atmosphere structure.\n\nArguments\n\nfile::String: path to a meteo file\nargs...: A list of arguments to transform the table. See above to see the possible forms.\ndate_format = DateFormat(\"yyyy-mm-ddTHH:MM:SS.s\"): the format for the DateTime columns\nhour_format = DateFormat(\"HH:MM:SS\"): the format for the Time columns (e.g. hour_start)\nduration: a function to parse the duration column if present in the file. Usually Dates.Day or Dates.Minute.\n\nIf the column is absent, the duration will be computed using the hour_format and the hour_start and hour_end columns along with the date column.\n\nExamples\n\nusing PlantMeteo, Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))),\"test\",\"data\",\"meteo.csv\")\n\nmeteo = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.rh_from_e-Tuple{Any, Any}","page":"API","title":"PlantMeteo.rh_from_e","text":"rh_from_e(VPD,eₛ)\n\nConversion between e (kPa) and rh (0-1).\n\nExamples\n\nrh_from_e(1.5,25.0)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.rh_from_vpd-Tuple{Any, Any}","page":"API","title":"PlantMeteo.rh_from_vpd","text":"rh_from_vpd(VPD,eₛ)\n\nConversion between VPD and rh.\n\nExamples\n\neₛ = e_sat(Tₐ)\nrh_from_vpd(1.5,eₛ)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.row_struct-Tuple{PlantMeteo.TimeStepRow}","page":"API","title":"PlantMeteo.row_struct","text":"row_struct(ts::TimeStepRow)\n\nGet TimeStepRow in its raw format, e.g. the NamedTuple that stores the values,  or the Atmosphere of values (or Status for PlantSimEngine.jl).\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.sample_weather-Tuple{PreparedWeather, Int64}","page":"API","title":"PlantMeteo.sample_weather","text":"sample_weather(prepared, step; window=RollingWindow(1.0), transforms=nothing)\n\nSample one aggregated weather row at step from a PreparedWeather sampler.\n\nArguments\n\nprepared::PreparedWeather: output of prepare_weather_sampler, holding source weather and optional cache.\nstep::Int: 1-based index in the original fine-step weather table.\n\nKeyword arguments\n\nwindow::AbstractSamplingWindow: selection strategy used before reduction. The default RollingWindow(1.0) behaves as an identity window.\ntransforms: optional transform override for this call. If nothing, uses prepared.transforms; otherwise accepted by normalize_sampling_transforms (e.g. NamedTuple or Vector{MeteoTransform}).\n\nReturns\n\nAn Atmosphere instance built from reduced variables over the selected window. When prepared.lazy == true, results are memoized by (step, window, transforms) and reused on repeated calls.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.select_weather","page":"API","title":"PlantMeteo.select_weather","text":"select_weather(w, vars=setdiff(propertynames(w), ATMOSPHERE_COMPUTED))\n\nSelect the variables to write in the weather data. The function returns a DataFrame with the selected variables.\n\nArguments\n\nw: a Tables.jl interfaced table, such as a TimeStepTable{Atmosphere} or a DataFrame\nvars: a vector of variables to write (as symbols). By default, all variables are written except the ones that\n\ncan be recomputed (see ATMOSPHERE_COMPUTED). If nothing is given, all variables are written.\n\nExamples\n\nusing PlantMeteo, Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))),\"test\",\"data\",\"meteo.csv\")\nw = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\ndf = select_weather(w)\n\n\n\n\n\n","category":"function"},{"location":"API/#PlantMeteo.standardize_columns!-Tuple{PlantMeteo.ToFileColumns, Any}","page":"API","title":"PlantMeteo.standardize_columns!","text":"standardize_columns!(::ToFileColumns, df)\nstandardize_columns!(::ToPlantMeteoColumns, df)\n\nStandardize the column names of a DataFrame built upon Atmospheres to be compatible with standard file systems (CSV, databases...).\n\nArguments\n\ndf: a DataFrame built upon Atmospheres\n\nExamples\n\nusing PlantMeteo, Dates, DataFrames\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))),\"test\",\"data\",\"meteo.csv\")\n\ndf = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n) |> DataFrame\n\ndf = standardize_columns!(ToFileColumns(), df)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.sum_duration-Tuple{T} where T<:(AbstractVector{<:Period})","page":"API","title":"PlantMeteo.sum_duration","text":"sum_duration(x::T) where {T<:AbstractVector{<:Dates.Period}}\nsum_duration(x::T) where {T<:AbstractVector{<:Dates.CompoundPeriod}}\n\nSum the durations in x and return a Dates.Day object.\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.timesteps_durations-Tuple{Vector{DateTime}}","page":"API","title":"PlantMeteo.timesteps_durations","text":"timesteps_durations(datetime::Dates.DateTime; verbose=true)\n\nDuration in sensible units (e.g. 1 hour, or 1 day), computed as the  duration between a step and the previous step. The first one is unknown, so we force it as the same as all (if unique), or the second one (if not) with a warning.\n\nThe function returns a Dates.CompoundPeriod because it helps finding a sensible default from a milliseconds period (e.g. 1 Hour or 1 Day).\n\nArguments\n\ndatetime::Vector{Dates.DateTime}: Vector of dates\nverbose::Bool=true: If true, print a warning if the duration is not \n\nconstant between the time steps.\n\nExamples\n\njulia> timesteps_durations([Dates.DateTime(2019, 1, 1, 0), Dates.DateTime(2019, 1, 1, 1)])\n2-element Vector{Dates.CompoundPeriod}:\n 1 hour\n 1 hour\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.to_daily-Tuple{Any, Vararg{Any}}","page":"API","title":"PlantMeteo.to_daily","text":"to_daily(df, args...)\nto_daily(t::T, args...) where {T<:TimeStepTable{<:Atmosphere}}\n\nTransform a DataFrame object or TimeStepTable{<:Atmosphere} with sub-daily time steps (e.g. 1h) to a daily time-step table.\n\nArguments\n\nt: a TimeStepTable{<:Atmosphere} with sub-daily time steps (e.g. 1h)\nargs: a list of transformations to apply to the data, formates as for DataFrames.jl\n\nNotes\n\nDefault transformations are applied to the data, and can be overriden by the user. The default transformations are:\n\n:date => (x -> unique(Dates.Date.(x))) => :date: the date is transformed into a Date object\n:duration => sum => :duration: the duration is summed\n:T => minimum => :Tmin: we use the minimum temperature for Tmin\n:T => maximum => :Tmax: and the maximum temperature for Tmax\n:Precipitations => sum => :Precipitations: the precipitations are summed\n:Rh => mean => :Rh: the relative humidity is averaged\n:Wind, :P, :Rh, :Cₐ, :e, :eₛ, :VPD, :ρ, :λ, :γ, :ε, :Δ, :clearness are \n\nall averaged\n\n[:Ri_SW_f, :duration] => ((x, y) -> sum(x .* Dates.toms.(y)) * 1.0e-9) => :Ri_SW_f: the irradiance is integrated, so its unit changes from W m⁻² to MJ m⁻² d⁻¹\nAll other irradiance variables are also integrated (see the code for details)\n\nNote that the default transformations can be overriden by the user, and that the default transformations are only applied if the variable is available.\n\nExamples\n\nusing PlantMeteo, Dates\n# Forecast for today and tomorrow:\nperiod = [today(), today()+Dates.Day(1)]\nw = get_weather(48.8566, 2.3522, period)\n# Convert to daily:\nw_daily = to_daily(w, :T => mean => :Tmean)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.vapor_pressure-Tuple{Any, Any}","page":"API","title":"PlantMeteo.vapor_pressure","text":"vapor_pressure(Tₐ, Rh; check=true)\n\nVapor pressure (kPa) at given temperature (°C) and relative hunidity (0-1).\n\nArguments\n\nTₐ (Celsius degree): air temperature\nRh (0-1): relative humidity\ncheck (Bool): if true, check that Rh is between 0 and 1\n\nExamples\n\nvapor_pressure(25.0, 0.4)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.vpd-Tuple{Any, Any}","page":"API","title":"PlantMeteo.vpd","text":"vpd(Rh,Tₐ)\n\nCompute vapor pressure deficit (kPa) from the air relative humidity (0-1) and temperature (°C).\n\nThe computation simply uses vpd = eₛ - e.\n\nExamples\n\nvpd(0.4,25.0)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.vpd_from_e-Tuple{Any, Any}","page":"API","title":"PlantMeteo.vpd_from_e","text":"vpd_from_e(e,Tₐ)\n\nCompute vapor pressure deficit (kPa) from the air vapor pressure (kPa) and temperature (°C).\n\nThe computation simply uses vpd = eₛ - e.\n\nExamples\n\nvpd_from_e(1.5,25.0)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.write_weather-Tuple{String, Any}","page":"API","title":"PlantMeteo.write_weather","text":"write_weather(\n    file, w; \n    vars=setdiff(propertynames(w), ATMOSPHERE_COMPUTED),\n    duration=Dates.Minute\n)\n\nWrite the weather data to a file. \n\nArguments\n\nfile: a String representing the path to the file to write\nw: a TimeStepTable{Atmosphere}\nvars: a vector of variables to write (as symbols). By default, all variables are written except the ones that \n\ncan be recomputed (see ATMOSPHERE_COMPUTED). If nothing is given, all variables are written.\n\nduration: the unit for formating the duration of the time steps. By default, it is Dates.Minute.\n\nExamples\n\nusing PlantMeteo, Dates\n\nfile = joinpath(dirname(dirname(pathof(PlantMeteo))),\"test\",\"data\",\"meteo.csv\")\nw = read_weather(\n    file,\n    :temperature => :T,\n    :relativeHumidity => (x -> x ./100) => :Rh,\n    :wind => :Wind,\n    :atmosphereCO2_ppm => :Cₐ,\n    date_format = DateFormat(\"yyyy/mm/dd\")\n)\n\nwrite_weather(\"meteo.csv\", w)\n\n\n\n\n\n","category":"method"},{"location":"API/#PlantMeteo.write_weather_-Tuple{String, Any}","page":"API","title":"PlantMeteo.write_weather_","text":"write_weather_(file, w)\n\nWrite the weather data to a file with a special-commented yaml header for the metadata.\n\n\n\n\n\n","category":"method"}]
}
